<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta property="og:title" content="æµ·è†½ä»”(å»šæˆ¿éƒ¨) - é›»å­è½å–®è¡¨">
    <meta property="og:description" content="é¦™æ¸¯å®é”æœ‰é™å…¬å¸æä¾›">
    <title>æµ·è†½ä»”(å»šæˆ¿éƒ¨) - å°ˆç”¨è¨‚è²¨å–®</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f8f9fa; padding-bottom: 120px; }
        
        /* é ‚éƒ¨å®¢è£½åŒ– */
        .top-bar { background-color: #212529; color: white; padding: 15px; position: sticky; top: 0; z-index: 1020; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .client-name { font-size: 1.3rem; font-weight: 800; color: #ffc107; } 
        .dept-badge { background-color: #d32f2f; color: white; font-size: 0.8rem; padding: 2px 8px; border-radius: 4px; margin-left: 5px; vertical-align: middle; }
        
        /* å°èˆªæŒ‰éˆ• */
        .nav-scroller { overflow-x: auto; white-space: nowrap; padding: 10px 10px 0 10px; background: white; border-bottom: 1px solid #ddd; position: sticky; top: 70px; z-index: 990; }
        .nav-btn { display: inline-block; padding: 8px 16px; margin-right: 8px; margin-bottom: 10px; border-radius: 20px; border: 1px solid #ccc; color: #333; text-decoration: none; font-size: 0.95rem; background: #fff; font-weight: 600; transition: all 0.2s; }
        .nav-btn.active { background: #212529; color: #ffc107; border-color: #212529; }

        /* æœå°‹æ¡† */
        .search-section { background-color: #f8f9fa; padding: 10px 15px; border-bottom: 1px solid #ddd; }
        .search-wrapper { position: relative; }
        .search-input { border-radius: 20px; border: 1px solid #ccc; padding: 8px 35px 8px 15px; width: 100%; }
        .btn-clear-search { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #adb5bd; cursor: pointer; font-size: 1.1rem; display: none; z-index: 10; }

        /* åˆ†é¡æ¨™é¡Œ */
        .category-header { background-color: #fff3cd; color: #212529; font-weight: 800; font-size: 1.1rem; padding: 10px 15px; border-left: 6px solid #ffc107; margin-top: 0; scroll-margin-top: 130px; }
        
        /* ç”¢å“åˆ—è¡¨ */
        .product-row { background: white; border-bottom: 1px solid #eee; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; }
        .p-info { flex: 1; padding-right: 10px; overflow: hidden; }
        .p-name { font-size: 1.1rem; font-weight: 700; color: #000; line-height: 1.3; margin-bottom: 2px; }
        .p-cat-label { font-size: 0.75rem; color: #999; }
        
        /* æ•¸é‡æ§åˆ¶ */
        .qty-control { display: flex; align-items: center; background: #fff; border: 1px solid #ced4da; border-radius: 8px; width: 120px; justify-content: space-between; height: 38px; flex-shrink: 0; overflow: hidden; }
        .qty-btn { width: 35px; height: 100%; border-radius: 0; background: #f8f9fa; color: #212529; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; font-size: 1.2rem; user-select: none; border: none; }
        .qty-btn:active { background: #ffc107; }
        .qty-input { width: 50px; text-align: center; border: none; font-weight: bold; font-size: 1.1rem; color: #333; background: transparent; padding: 0; }
        
        /* é¸ä¸­æ¨£å¼ */
        .product-row.selected { background-color: #fff9db; border-left: 5px solid #ffc107; }

        /* åº•éƒ¨çµå¸³æ¬„ */
        .bottom-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: white; box-shadow: 0 -4px 15px rgba(0,0,0,0.15); padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; z-index: 1030; gap: 10px; }
        .total-box { font-size: 1.1rem; font-weight: bold; color: #333; }
        .total-num { color: #d32f2f; font-size: 1.4rem; padding: 0 3px; }
        
        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-view-cart { background-color: #6c757d; color: white; border: none; padding: 10px 18px; border-radius: 50px; font-weight: bold; font-size: 0.95rem; white-space: nowrap; transition: all 0.3s ease; }
        .btn-view-cart.active { background: linear-gradient(45deg, #ff9800, #ff5722); box-shadow: 0 4px 12px rgba(255, 87, 34, 0.4); transform: scale(1.05); }
        .btn-whatsapp { background-color: #25D366; color: white; border: none; padding: 10px 20px; border-radius: 50px; font-weight: bold; font-size: 1.1rem; flex-grow: 1; display: flex; align-items: center; justify-content: center; gap: 5px; box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3); }

        /* Modal Styles */
        .modal-header { background-color: #212529; color: white; }
        .modal-title { font-weight: bold; color: #ffc107; }
    </style>
</head>
<body>

<div class="sticky-header-container">
    <div class="top-bar d-flex justify-content-between align-items-center">
        <div>
            <div class="client-name">æµ·è†½ä»” <span class="dept-badge">å»šæˆ¿éƒ¨</span></div>
            <div style="font-size: 0.8rem; color: #ccc;">A2888A</div>
        </div>
        <div style="text-align: right; font-size: 0.8rem; color: #ccc;">
            å®é”æ‰¹ç™¼<br>Tel: 63771688
        </div>
    </div>

    <div class="nav-scroller" id="navContainer"></div>

    <div class="search-section">
        <div class="search-wrapper">
            <input type="text" id="searchInput" class="search-input" placeholder="ğŸ” æœå°‹å»šæˆ¿è²¨å“..." oninput="filterProducts()">
            <i class="bi bi-x-circle-fill btn-clear-search" id="clearSearchBtn" onclick="clearSearch()"></i>
        </div>
    </div>
</div>

<div id="product-list" style="padding-top: 10px;"></div>

<div class="bottom-bar">
    <div class="total-box">
        å…± <span id="totalQty" class="total-num">0</span> æ¬¾
    </div>
    <button id="viewCartBtn" class="btn-view-cart" onclick="openCartModal()" disabled>
        <i class="bi bi-cart3"></i> æŸ¥çœ‹å·²é¸
    </button>
    <button class="btn-whatsapp" onclick="sendWhatsApp()">
        <i class="bi bi-whatsapp"></i> ç™¼é€è¨‚å–®
    </button>
</div>

<div class="modal fade" id="cartModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">å·²é¸ç”¢å“æ¸…å–®</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="cartModalBody"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-danger me-auto" onclick="clearCart()">
                    <i class="bi bi-trash"></i> æ¸…ç©º
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ç¹¼çºŒé¸è³¼</button>
                <button type="button" class="btn btn-success" onclick="sendWhatsApp()">ç¢ºèªç™¼é€</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const customerName = "æµ·è†½ä»”(å»šæˆ¿éƒ¨)";
    const customerCode = "A2888A";

    // === ç”¢å“æ•¸æ“šåº« ===
    const products = [
        { name: "å¹¼é¹½", cat: "ä¸€ã€å¹²è²¨" }, { name: "ä¸Šç™½ç³–", cat: "ä¸€ã€å¹²è²¨" }, { name: "å¤©å©¦ç¾…ç²‰", cat: "ä¸€ã€å¹²è²¨" }, { name: "QPæ²™å¾‹æ±", cat: "ä¸€ã€å¹²è²¨" }, { name: "å’–å–±ç£š (è¾›å£)", cat: "ä¸€ã€å¹²è²¨" }, { name: "å’–å–±ç£š (ç”˜å£)", cat: "ä¸€ã€å¹²è²¨" }, { name: "å¤§ç´«èœ", cat: "ä¸€ã€å¹²è²¨" }, { name: "è’œç²‰", cat: "ä¸€ã€å¹²è²¨" }, { name: "é›æ±", cat: "ä¸€ã€å¹²è²¨" }, { name: "éº»æ²¹", cat: "ä¸€ã€å¹²è²¨" }, { name: "å‘³æ·‹ (æ”¯)", cat: "ä¸€ã€å¹²è²¨" }, { name: "ç…®é…’ (æ”¯)", cat: "ä¸€ã€å¹²è²¨" }, { name: "æ˜†å¸ƒé°¹é­šæ±", cat: "ä¸€ã€å¹²è²¨" }, { name: "æŸšå­é†‹", cat: "ä¸€ã€å¹²è²¨" }, { name: "5è™Ÿä»”", cat: "ä¸€ã€å¹²è²¨" }, { name: "é°»é­šæ±", cat: "ä¸€ã€å¹²è²¨" }, { name: "é£Ÿç ”çƒ¤è‚‰é†¬", cat: "ä¸€ã€å¹²è²¨" }, { name: "ç”Ÿè–‘æ±", cat: "ä¸€ã€å¹²è²¨" }, { name: "ç¢æµ·è‰", cat: "ä¸€ã€å¹²è²¨" }, { name: "æ³¡èœé†¬ (æ¡ƒå±‹)", cat: "ä¸€ã€å¹²è²¨" }, { name: "914ä¿é®®è†œ", cat: "ä¸€ã€å¹²è²¨" }, { name: "æ—¥æœ¬é’æ¤’ä»”", cat: "ä¸€ã€å¹²è²¨" }, { name: "æ‹‰éºµç­", cat: "ä¸€ã€å¹²è²¨" }, { name: "å¤©æ²¹", cat: "ä¸€ã€å¹²è²¨" }, { name: "é†«ç”Ÿæ‰‹å¥—M", cat: "ä¸€ã€å¹²è²¨" }, { name: "ç„¡å‘³æ²¹æš", cat: "ä¸€ã€å¹²è²¨" }, { name: "æœ¨é­šç²¾", cat: "ä¸€ã€å¹²è²¨" }, { name: "è¬å­—è±‰æ²¹ (æ”¯)", cat: "ä¸€ã€å¹²è²¨" }, { name: "æœ¨é­šçµ²", cat: "ä¸€ã€å¹²è²¨" }, { name: "å‘³é¹½", cat: "ä¸€ã€å¹²è²¨" }, { name: "å‘³æ¤’é¹½", cat: "ä¸€ã€å¹²è²¨" }, { name: "ç«¹å¶", cat: "ä¸€ã€å¹²è²¨" }, { name: "æ—¥æœ¬ç•ªè–¯", cat: "ä¸€ã€å¹²è²¨" }, { name: "æ—¥æœ¬å—ç“œ", cat: "ä¸€ã€å¹²è²¨" },
        { name: "ç†Ÿé£Ÿå¸¶å­ (L)", cat: "äºŒã€å‡è²¨" }, { name: "ç†Ÿé£Ÿå¸¶å­ (5S)", cat: "äºŒã€å‡è²¨" }, { name: "æè±†", cat: "äºŒã€å‡è²¨" }, { name: "é³´é–€å·", cat: "äºŒã€å‡è²¨" }, { name: "è±¬éª¨Qæ¹¯", cat: "äºŒã€å‡è²¨" }, { name: "è•éº¥é¢", cat: "äºŒã€å‡è²¨" }, { name: "çƒå†¬", cat: "äºŒã€å‡è²¨" }, { name: "è±¬è»Ÿéª¨", cat: "äºŒã€å‡è²¨" }, { name: "é°»é­š (40)", cat: "äºŒã€å‡è²¨" }, { name: "é°»é­š (80)", cat: "äºŒã€å‡è²¨" }, { name: "å‰ç‡’", cat: "äºŒã€å‡è²¨" }, { name: "è‚¥ç‰›ç‰‡", cat: "äºŒã€å‡è²¨" }, { name: "é›è‚‰å·", cat: "äºŒã€å‡è²¨" }, { name: "å»£å³¶è ” (2L)", cat: "äºŒã€å‡è²¨" }, { name: "æ€¥å‡èœ†", cat: "äºŒã€å‡è²¨" }, { name: "å·´è¥¿é›æ‰’ (åŒ…)", cat: "äºŒã€å‡è²¨" }, { name: "æ³¡èœ", cat: "äºŒã€å‡è²¨" }, { name: "å¹¹æ‹‰éºµ (ç®±)", cat: "äºŒã€å‡è²¨" }, { name: "ä¸€ä¼‘é¢è±‰", cat: "äºŒã€å‡è²¨" }, { name: "è¥¿äº¬ç™½éºµè±‰", cat: "äºŒã€å‡è²¨" },
        { name: "å¤©å©¦ç¾…è¦", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "é­·é­šå¤©å©¦ç¾…", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "ç‚¸é›å¡Š", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "å”æšé›è»Ÿéª¨CP", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "èŠéº»é›ç¿¼", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "é›çš®é¤ƒå­", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "æ—¥å¼é¤ƒå­", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "æµ·è†½é­šé¤…", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "é»ƒå‰åˆ—è¦", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "æ—¥æœ¬å‰åˆ—ç‚¸è ”", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "å‰åˆ—è±¬æ‰’130g", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "é»‘è±šè‚‰çœ¼", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "æ«»èŠ±è±†è…", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "ç« é­šå°ä¸¸å­", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "èŠå£«å¹´ç³•", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "æ—¥æœ¬æ˜å¤ªå­é›ç¿¼", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "ç”˜æ —ç´«è–¯é¤…", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "è»Ÿæ®¼èŸ¹100gå°", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "è»Ÿæ®¼èŸ¹120gå¤§", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "ç‚¸èŸ¹é‰—", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "ä¸€å£èŠå£«", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "é»‘è±šç‚¸è‚‰é¤…", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "å‰åˆ—é­šæŸ³", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" }, { name: "é¢åŒ…ç³ ", cat: "ä¸‰ã€ç‚¸ç‰©å‡è²¨" },
        { name: "é›çš®ä¸² (50)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é›è…¿è‚‰ä¸² (ä¸²)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é›è…ä¸² (50)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é¸¡ä¸­ç¿¼ä¸² (20)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é›é ¸è‚‰ä¸²", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "è‚¥è…¸ (ä¸²)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "ç‰›èˆŒ", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "è´è¶è‚‰", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "åˆ©é ­", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "ä¸€å£ç‰›ç²’", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é­·é­šç­’", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é¯–é­š200g", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "éŠ€é±ˆé­š", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "æ˜å¤ªå­ (1K)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "ç”²ç½—çƒ§", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é­šå‹é­šå¹²", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "äº”èŠ±è…©ä¸²", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "ç™½é±”ä¸²", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "é¸¡è½¯éª¨ä¸² (50)", cat: "å››ã€ä¸²ç‡’å‡è²¨" }, { name: "å…æ²»é›è‚‰æ£’", cat: "å››ã€ä¸²ç‡’å‡è²¨" }
    ];

    // ç”Ÿæˆ ID (K001, K002...)
    products.forEach((p, index) => {
        p.id = "K" + (index + 1).toString().padStart(3, '0');
    });

    let cart = {}; 
    let cartModal = null;

    // === åˆå§‹åŒ– ===
    function init() {
        loadCart(); 
        renderNav();
        renderTable();
        cartModal = new bootstrap.Modal(document.getElementById('cartModal'));
    }

    // === è¨˜æ†¶åŠŸèƒ½ ===
    function loadCart() {
        const savedCart = localStorage.getItem('orderCart_' + customerCode);
        if (savedCart) {
            try { cart = JSON.parse(savedCart); } catch(e) { console.error("Error", e); }
        }
        calculateTotal();
    }

    function saveCart() {
        localStorage.setItem('orderCart_' + customerCode, JSON.stringify(cart));
    }

    // === æ¸²æŸ“å°èˆª ===
    function renderNav() {
        const categories = [...new Set(products.map(p => p.cat))];
        const container = document.getElementById('navContainer');
        container.innerHTML = `<a href="javascript:void(0)" class="nav-btn active" onclick="filterCat('all', this)">å…¨éƒ¨</a>`;
        categories.forEach(cat => {
            const displayCat = cat.split('ã€')[1] || cat; 
            container.innerHTML += `<a href="#cat-${cat}" class="nav-btn" onclick="filterCat('${cat}', this)">${displayCat}</a>`;
        });
    }

    function filterCat(cat, btn) {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if (cat === 'all') {
            document.querySelectorAll('.category-section').forEach(el => el.style.display = 'block');
            window.scrollTo(0, 0);
        } else {
            const target = document.getElementById(`cat-${cat}`);
            if (target) {
                const offset = 140; 
                const elementPosition = target.getBoundingClientRect().top + window.pageYOffset;
                window.scrollTo({ top: elementPosition - offset, behavior: "smooth" });
            }
        }
    }

    // === æ¸²æŸ“ç”¢å“åˆ—è¡¨ ===
    function renderTable(filterText = "") {
        const container = document.getElementById('product-list');
        let html = '';
        let currentCat = '';
        
        const filteredProducts = products.filter(p => {
            if (!filterText) return true;
            return p.name.includes(filterText);
        });

        filteredProducts.forEach(p => {
            if (!filterText && p.cat !== currentCat) {
                currentCat = p.cat;
                html += `<div class="category-header category-section" id="cat-${currentCat}">${currentCat}</div>`;
            }
            html += createRowHtml(p);
        });

        if (filteredProducts.length === 0) {
            html = '<div class="text-center p-5 text-muted">æ‰¾ä¸åˆ°ç›¸é—œç”¢å“</div>';
        }
        container.innerHTML = html;
    }

    function createRowHtml(p) {
        const qty = cart[p.id] || 0;
        const rowClass = qty > 0 ? 'selected' : '';
        return `
        <div class="product-row ${rowClass}" id="row-${p.id}">
            <div class="p-info">
                <div class="p-name">${p.name}</div>
                <div class="p-cat-label">${p.cat.split('ã€')[1] || p.cat}</div>
            </div>
            <div class="qty-control">
                <div class="qty-btn" onclick="updateQty('${p.id}', -1)">-</div>
                <input type="text" class="qty-input" id="qty-${p.id}" value="${qty}" readonly>
                <div class="qty-btn" onclick="updateQty('${p.id}', 1)">+</div>
            </div>
        </div>`;
    }

    function filterProducts() {
        const text = document.getElementById('searchInput').value;
        const clearBtn = document.getElementById('clearSearchBtn');
        clearBtn.style.display = text.length > 0 ? 'block' : 'none';
        renderTable(text);
    }

    function clearSearch() {
        document.getElementById('searchInput').value = '';
        document.getElementById('clearSearchBtn').style.display = 'none';
        renderTable('');
    }

    // === æ ¸å¿ƒæ›´æ–°é‚è¼¯ ===
    function updateQty(id, delta) {
        if (!cart[id]) cart[id] = 0;
        cart[id] += delta;
        if (cart[id] <= 0) delete cart[id];
        
        const mainInput = document.getElementById(`qty-${id}`);
        if (mainInput) {
            mainInput.value = cart[id] || 0;
            const row = document.getElementById(`row-${id}`);
            if (cart[id] > 0) row.classList.add('selected');
            else row.classList.remove('selected');
        }

        if (document.getElementById('cartModal').classList.contains('show')) {
            renderCartModalItems();
        }
        
        saveCart();
        calculateTotal();
    }

    function calculateTotal() {
        let count = 0;
        for (let key in cart) count++; 
        document.getElementById('totalQty').innerText = count;
        
        const btn = document.getElementById('viewCartBtn');
        if (count > 0) {
            btn.classList.add('active');
            btn.disabled = false;
            btn.innerHTML = `<i class="bi bi-cart-check-fill"></i> æŸ¥çœ‹å·²é¸ (${count})`;
        } else {
            btn.classList.remove('active');
            btn.disabled = true;
            btn.innerHTML = `<i class="bi bi-cart3"></i> æŸ¥çœ‹å·²é¸`;
        }
    }

    // === è³¼ç‰©è»Š Modal é‚è¼¯ ===
    function openCartModal() {
        renderCartModalItems();
        cartModal.show();
    }

    function renderCartModalItems() {
        const container = document.getElementById('cartModalBody');
        const items = products.filter(p => cart[p.id]);
        
        if (items.length === 0) {
            container.innerHTML = '<div class="text-center p-4 text-muted">å°šæœªé¸æ“‡ä»»ä½•ç”¢å“</div>';
            return;
        }

        let html = '';
        items.forEach(p => {
            const qty = cart[p.id];
            html += `
            <div class="product-row selected">
                <div class="p-info">
                    <div class="p-name">${p.name}</div>
                </div>
                <div class="qty-control">
                    <div class="qty-btn" onclick="updateQty('${p.id}', -1)">-</div>
                    <input type="text" class="qty-input" value="${qty}" readonly>
                    <div class="qty-btn" onclick="updateQty('${p.id}', 1)">+</div>
                </div>
            </div>`;
        });
        container.innerHTML = html;
    }

    function clearCart() {
        if (Object.keys(cart).length === 0) return;
        if (confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰å·²é¸è²¨å“å—ï¼Ÿ")) {
            cart = {};
            localStorage.removeItem('orderCart_' + customerCode);
            renderTable(); 
            calculateTotal();
            renderCartModalItems(); 
        }
    }

    // === ç™¼é€ WhatsApp ===
    function sendWhatsApp() {
        if (Object.keys(cart).length === 0) {
            alert("è«‹å…ˆé¸æ“‡ç”¢å“ï¼");
            return;
        }

        let msg = `${customerName} è¨‚è²¨å–®ï¼š\n(å®¢æˆ¶ç·¨è™Ÿ: ${customerCode})\n`;
        msg += "------------------------\n";
        
        const orderedCart = products.filter(p => cart[p.id]);
        
        orderedCart.forEach(p => {
            const q = cart[p.id];
            msg += ` ${q}  ${p.name}\n`; 
        });

        msg += "------------------------\n";
        msg += "éº»ç…©æ™’ï¼"; 

        const phone = "85263771688";
        const url = `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
        window.open(url, '_blank');
    }

    init();
</script>

</body>
</html>
